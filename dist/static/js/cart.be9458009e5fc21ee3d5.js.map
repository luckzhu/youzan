{"version":3,"sources":["webpack:///./src/modules/js/api.js","webpack:///./src/modules/js/mixin.js","webpack:///./src/modules/js/cartService.js","webpack:///./src/pages/cart/cart.js","webpack:///./src/modules/js/fetch.js"],"names":["url","hotLists","bannerLists","topList","rank","subList","searchList","goodsDetails","goodsDeals","addCart","reduceCart","removeCart","moreRemove","updateCart","cartList","addressLists","addAddress","removeAddress","updateAddress","setDefaultAddress","key","hasOwnProperty","mixin","filters","priceFormat","price","parseFloat","toFixed","Cart","id","fetch","number","Vue","el","data","lists","totalPrice","editShop","editShopIndex","computed","allSlected","get","this","length","every","shop","checked","set","newVal","forEach","goodsList","good","allRemoveSlected","removeChecked","selectedList","arr","total","push","removedList","created","getLists","methods","_this","axios","then","res","editing","editingMsg","changeShop","attr","changeChecked","changeAllSelected","edit","shopIndex","item","i","plusGoods","add","minusGoods","reduce","removeGood","goodIndex","_this2","message_box_default","a","confirm","action","post","splice","removeShop","morReduce","_this3","ids","findIndex","start","e","startX","changedTouches","clientX","end","endX","left","Velocity","$refs","mixins","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default","resolve","reject","status","location","href","catch","err"],"mappings":"qHAAA,IAAIA,GACAC,SAAU,iBACVC,YAAa,eACbC,QAAS,mBACTC,KAAM,gBACNC,QAAS,mBACTC,WAAY,cACZC,aAAc,gBACdC,WAAY,aACZC,QAAS,WACTC,WAAY,cACZC,WAAY,cACZC,WAAY,gBACZC,WAAY,cACZC,SAAU,YACVC,aAAc,eACdC,WAAY,cACZC,cAAe,iBACfC,cAAe,iBACfC,kBAAmB,sBAWvB,IAAK,IAAIC,KAAOpB,EACRA,EAAIqB,eAAeD,KACnBpB,EAAIoB,GALD,2CAKepB,EAAIoB,IAIfpB,2CCpCf,IAAIsB,GACAC,SACIC,YADI,SACQC,GACT,OAAOC,WAAWD,GAAOE,QAAQ,MAK7BL,sTCWAM,mFAfAC,GACP,OAAOC,YAAM9B,IAAIS,SACboB,KACAE,OAAQ,mCAIFF,GACV,OAAOC,YAAM9B,IAAIU,YACbmB,KACAE,OAAQ,aCApB,IAAIC,WACAC,GAAI,aACJC,MACIC,MAAO,KACPC,WAAY,EACZC,SAAU,KACVC,eAAgB,GAEpBC,UACIC,YACIC,IADQ,WAEJ,SAAIC,KAAKP,QAASO,KAAKP,MAAMQ,SAClBD,KAAKP,MAAMS,MAAM,SAAAC,GACpB,OAAOA,EAAKC,WAKxBC,IATQ,SASJC,GACAN,KAAKP,MAAMc,QAAQ,SAAAJ,GACfA,EAAKC,QAAUE,EACfH,EAAKK,UAAUD,QAAQ,SAAAE,GACnBA,EAAKL,QAAUE,QAM/BI,kBACIX,IADc,WAEV,QAAIC,KAAKL,SAASgB,eAKtBN,IAPc,SAOVC,GACAN,KAAKL,SAASgB,cAAgBL,EAC9BN,KAAKL,SAASa,UAAUD,QAAQ,SAAAE,GAC5BA,EAAKE,cAAgBL,MAKjCM,aAnCM,WAoCF,IAAIC,KACAC,EAAQ,EAYZ,OAXId,KAAKP,OAASO,KAAKP,MAAMQ,QACzBD,KAAKP,MAAMc,QAAQ,SAAAJ,GACfA,EAAKK,UAAUD,QAAQ,SAAAE,GACfA,EAAKL,UACLS,EAAIE,KAAKN,GACTK,GAASL,EAAKpB,OAASoB,EAAK1B,WAK5CiB,KAAKN,WAAaoB,EACXD,GAGXG,YApDM,WAqDF,IAAIH,KACJ,OAAIb,KAAKL,UACLK,KAAKL,SAASa,UAAUD,QAAQ,SAAAE,GACxBA,EAAKE,eACLE,EAAIE,KAAKN,KAGVI,QAMnBI,QA1EI,WA2EAjB,KAAKkB,YAETC,SACID,SADK,WACM,IAAAE,EAAApB,KACPqB,IAAMtB,IAAIzC,IAAIc,UAAUkD,KAAK,SAAAC,GACzB,IAAI9B,EAAQ8B,EAAI/B,KAAKpB,SACrBqB,EAAMc,QAAQ,SAAAJ,GACVA,EAAKqB,SAAU,EACfrB,EAAKsB,WAAa,KAClBtB,EAAKC,SAAU,EACfD,EAAKQ,eAAgB,EAErBR,EAAKK,UAAUD,QAAQ,SAAAE,GACnBA,EAAKL,SAAU,EACfK,EAAKE,eAAgB,MAG7BS,EAAK3B,MAAQA,KAGrBiC,WAlBK,SAkBMvB,GACP,IAAIwB,EAAO3B,KAAKL,SAAW,gBAAkB,UAC7CQ,EAAKwB,IAASxB,EAAKwB,GACnBxB,EAAKK,UAAUD,QAAQ,SAAAE,GACnBA,EAAKkB,GAAQxB,EAAKwB,MAG1BC,cAzBK,SAyBSzB,EAAMM,GAChB,IAAIkB,EAAO3B,KAAKL,SAAW,gBAAkB,UAC7Cc,EAAKkB,IAASlB,EAAKkB,GACnBxB,EAAKwB,GAAQxB,EAAKK,UAAUN,MAAM,SAAAO,GAC9B,OAAOA,EAAKkB,MAIpBE,kBAjCK,WAkCD,IAAIF,EAAO3B,KAAKL,SAAW,mBAAqB,aAChDK,KAAK2B,IAAS3B,KAAK2B,IAEvBG,KArCK,SAqCA3B,EAAM4B,GACP5B,EAAKqB,SAAWrB,EAAKqB,QACrBrB,EAAKsB,WAAatB,EAAKqB,QAAU,KAAO,KACxCxB,KAAKP,MAAMc,QAAQ,SAACyB,EAAMC,GAClBF,GAAaE,IACbD,EAAKR,SAAU,EACfQ,EAAKP,WAAatB,EAAKqB,QAAU,GAAK,QAI1CrB,EAAKqB,SACLxB,KAAKL,SAAWQ,EAChBH,KAAKJ,cAAgBmC,IAGrB/B,KAAKL,SAAW,KAChBK,KAAKJ,eAAiB,IAI9BsC,UAzDK,SAyDKzB,GACNvB,EAAKiD,IAAI1B,EAAKtB,IAAImC,KAAK,SAAAC,GACnBd,EAAKpB,YASb+C,WApEK,SAoEM3B,GACa,IAAhBA,EAAKpB,QACTH,EAAKmD,OAAO5B,EAAKtB,IAAImC,KAAK,SAAAC,GACtBd,EAAKpB,YASbiD,WAhFK,SAgFMnC,EAAM4B,EAAWtB,EAAM8B,GAAW,IAAAC,EAAAxC,KACzCyC,EAAAC,EAAWC,QAAQ,aAAarB,KAAK,SAAAsB,GACjCvB,IAAMwB,KAAKvF,IAAIW,YACXkB,GAAIsB,EAAKtB,KACVmC,KAAK,SAAAC,GACJpB,EAAKK,UAAUsC,OAAOP,EAAW,GAE5BpC,EAAKK,UAAUP,SAChBuC,EAAK/C,MAAMqD,OAAOf,EAAW,GAC7BS,EAAKO,mBAOrBA,WAhGK,WAiGD/C,KAAKL,SAAW,KAChBK,KAAKJ,eAAiB,EACtBI,KAAKP,MAAMc,QAAQ,SAACJ,GAChBA,EAAKqB,SAAU,EACfrB,EAAKsB,WAAa,QAG1BuB,UAxGK,WAwGO,IAAAC,EAAAjD,KACRyC,EAAAC,EAAWC,QAAX,QAA2B3C,KAAKgB,YAAYf,OAA5C,SAA2DqB,KAAK,SAAAsB,GAE5D,IAAIM,KACJD,EAAKjC,YAAYT,QAAQ,SAAA0B,GACrBiB,EAAInC,KAAKkB,EAAE9C,MAEfkC,IAAMwB,KAAKvF,IAAIY,YACXgF,QACD5B,KAAK,SAAAC,GACJ,IAAIV,KACJoC,EAAKtD,SAASa,UAAUD,QAAQ,SAAAE,IAIb,IAHHwC,EAAKjC,YAAYmC,UAAU,SAAAnB,GACnC,OAAOA,EAAK7C,GAAKsB,EAAKtB,MAGtB0B,EAAIE,KAAKN,KAGbI,EAAIZ,OACJgD,EAAKtD,SAASa,UAAYK,GAE1BoC,EAAKxD,MAAMqD,OAAOG,EAAKrD,cAAe,GACtCqD,EAAKF,mBAKrBK,MApIK,SAoICC,EAAG5C,GACLA,EAAK6C,OAASD,EAAEE,eAAe,GAAGC,SAEtCC,IAvIK,SAuIDJ,EAAGtB,EAAWtB,EAAM8B,GACpB,IAAImB,EAAOL,EAAEE,eAAe,GAAGC,QAC3BG,EAAO,IACPlD,EAAK6C,OAASI,EAAO,IACrBC,EAAO,QACAD,EAAOjD,EAAK6C,OAAS,MAC5BK,EAAO,OAGXC,IAAS5D,KAAK6D,MAAL,SAAoB9B,EAApB,IAAiCQ,IACtCoB,WAIZG,QAASlF,wFC5NEQ,IAlBf,SAAe9B,EAAKkC,GAChB,OAAO,IAAIuE,EAAArB,EAAQ,SAACsB,EAASC,GACzB5C,IAAMtB,IAAIzC,EAAKkC,GAAM8B,KAAK,SAAAC,GACtB,IAAI2C,EAAS3C,EAAI/B,KAAK0E,OACP,MAAXA,GACAF,EAAQzC,GAEG,MAAX2C,IACAC,SAASC,KAAO,aAChBJ,EAAQzC,IAEZ0C,EAAO1C,KACR8C,MAAM,SAAAC,GACLL,EAAOK","file":"static/js/cart.be9458009e5fc21ee3d5.js","sourcesContent":["let url = {\n    hotLists: 'index/hotLists',\n    bannerLists: 'index/banner',\n    topList: 'category/topList',\n    rank: 'category/rank',\n    subList: 'category/subList',\n    searchList: 'search/list',\n    goodsDetails: 'goods/details',\n    goodsDeals: 'goods/deal',\n    addCart: 'cart/add',\n    reduceCart: 'cart/reduce',\n    removeCart: 'cart/remove',\n    moreRemove: 'cart/mrremove',\n    updateCart: 'cart/update',\n    cartList: 'cart/list',\n    addressLists: 'address/list',\n    addAddress: 'address/add',\n    removeAddress: 'address/remove',\n    updateAddress: 'address/update',\n    setDefaultAddress: 'address/setDefault'\n    \n\n}\n\n//开发环境和真实环境的切换\n//let host = ''\n//现在用的是开发环境mock的接口数据\nlet host = 'http://rap2api.taobao.org/app/mock/7058/'\n\n//把所有的url前面都加上host\nfor (let key in url) {\n    if (url.hasOwnProperty(key)) {\n        url[key] = host + url[key];\n    }\n}\n\nexport default url\n\n\n// WEBPACK FOOTER //\n// ./src/modules/js/api.js","let mixin = {\n    filters:{\n        priceFormat(price){\n           return parseFloat(price).toFixed(2)\n        }\n    }\n}\n\nexport default mixin\n\n\n// WEBPACK FOOTER //\n// ./src/modules/js/mixin.js","import fetch from './fetch'\r\nimport url from './api'\r\n\r\nclass Cart{\r\n    static add(id){\r\n        return fetch(url.addCart,{\r\n            id,\r\n            number: 1\r\n        })\r\n    }\r\n\r\n    static reduce(id){\r\n        return fetch(url.reduceCart,{\r\n            id,\r\n            number: 1\r\n        })\r\n    }\r\n}\r\n\r\nexport default Cart\n\n\n// WEBPACK FOOTER //\n// ./src/modules/js/cartService.js","import './cart.css'\nimport './cart_trade.css'\nimport './cart_base.css'\n\nimport Vue from 'vue'\nimport axios from 'axios'\nimport mixin from 'js/mixin.js'\nimport url from 'js/api.js'\nimport Velocity from 'velocity-animate'\nimport Cart from 'js/cartService.js'\n\nimport { MessageBox } from 'mint-ui';\n\n\nnew Vue({\n    el: '.container',\n    data: {\n        lists: null,\n        totalPrice: 0,\n        editShop: null,\n        editShopIndex: -1\n    },\n    computed: {\n        allSlected: {\n            get() {\n                if (this.lists && this.lists.length) {\n                    return this.lists.every(shop => {\n                        return shop.checked\n                    })\n                }\n                return false\n            },\n            set(newVal) {\n                this.lists.forEach(shop => {\n                    shop.checked = newVal\n                    shop.goodsList.forEach(good => {\n                        good.checked = newVal\n                    });\n                });\n            }\n        },\n\n        allRemoveSlected: {\n            get() {\n                if (this.editShop.removeChecked) {\n                    return true\n                }\n                return false\n            },\n            set(newVal) {\n                this.editShop.removeChecked = newVal\n                this.editShop.goodsList.forEach(good => {\n                    good.removeChecked = newVal\n                });\n            }\n        },\n\n        selectedList() {\n            let arr = []\n            let total = 0\n            if (this.lists && this.lists.length) {\n                this.lists.forEach(shop => {\n                    shop.goodsList.forEach(good => {\n                        if (good.checked) {\n                            arr.push(good)\n                            total += good.number * good.price\n                        }\n                    })\n                })\n            }\n            this.totalPrice = total\n            return arr\n        },\n\n        removedList() {\n            let arr = []\n            if (this.editShop) {\n                this.editShop.goodsList.forEach(good => {\n                    if (good.removeChecked) {\n                        arr.push(good)\n                    }\n                })\n                return arr\n            }\n            return []\n        }\n\n    },\n    created() {\n        this.getLists()\n    },\n    methods: {\n        getLists() {\n            axios.get(url.cartList).then(res => {\n                let lists = res.data.cartList\n                lists.forEach(shop => {\n                    shop.editing = false\n                    shop.editingMsg = '编辑'\n                    shop.checked = true\n                    shop.removeChecked = false\n\n                    shop.goodsList.forEach(good => {\n                        good.checked = true\n                        good.removeChecked = false\n                    });\n                });\n                this.lists = lists\n            })\n        },\n        changeShop(shop) {\n            let attr = this.editShop ? 'removeChecked' : 'checked'\n            shop[attr] = !shop[attr]\n            shop.goodsList.forEach(good => {\n                good[attr] = shop[attr]\n            });\n        },\n        changeChecked(shop, good) {\n            let attr = this.editShop ? 'removeChecked' : 'checked'\n            good[attr] = !good[attr]\n            shop[attr] = shop.goodsList.every(good => {\n                return good[attr]\n            })\n        },\n\n        changeAllSelected() {\n            let attr = this.editShop ? 'allRemoveSlected' : 'allSlected'\n            this[attr] = !this[attr]\n        },\n        edit(shop, shopIndex) {\n            shop.editing = !shop.editing\n            shop.editingMsg = shop.editing ? '完成' : '编辑'\n            this.lists.forEach((item, i) => {\n                if (shopIndex != i) {\n                    item.editing = false\n                    item.editingMsg = shop.editing ? '' : '编辑'\n                }\n            })\n\n            if (shop.editing) {\n                this.editShop = shop\n                this.editShopIndex = shopIndex\n            }\n            else {\n                this.editShop = null\n                this.editShopIndex = -1\n            }\n\n        },\n        plusGoods(good) {\n            Cart.add(good.id).then(res => {\n                good.number++\n            })\n            // axios.post(url.addCart, {\n            //     id: good.id,\n            //     number: 1\n            // }).then(res => {\n            //     good.number++\n            // })\n        },\n        minusGoods(good) {\n            if (good.number === 1) return\n            Cart.reduce(good.id).then(res => {\n                good.number--\n            })\n            // axios.post(url.reduceCart, {\n            //     id: good.id,\n            //     number: 1\n            // }).then(res => {\n            //     good.number--\n            // })\n        },\n        removeGood(shop, shopIndex, good, goodIndex) {\n            MessageBox.confirm('确定删除此商品吗?').then(action => {\n                axios.post(url.removeCart, {\n                    id: good.id\n                }).then(res => {\n                    shop.goodsList.splice(goodIndex, 1)\n\n                    if (!shop.goodsList.length) {\n                        this.lists.splice(shopIndex, 1)\n                        this.removeShop()\n                    }\n                    // 可解决右划删除的bug，现在用key\n                    // this.$refs[`goods-${shopIndex}-${goodIndex}`][0].style.left='0px'\n                })\n            })\n        },\n        removeShop() {\n            this.editShop = null\n            this.editShopIndex = -1\n            this.lists.forEach((shop) => {\n                shop.editing = false\n                shop.editingMsg = '编辑'\n            })\n        },\n        morReduce() {\n            MessageBox.confirm(`确认删除这${this.removedList.length}件商品吗？`).then(action => {\n\n                let ids = []\n                this.removedList.forEach(i => {\n                    ids.push(i.id)\n                });\n                axios.post(url.moreRemove, {\n                    ids\n                }).then(res => {\n                    let arr = []\n                    this.editShop.goodsList.forEach(good => {\n                        let index = this.removedList.findIndex(item => {\n                            return item.id = good.id\n                        })\n                        if (index === -1) {\n                            arr.push(good)\n                        }\n                    })\n                    if (arr.length) {\n                        this.editShop.goodsList = arr\n                    } else {\n                        this.lists.splice(this.editShopIndex, 1)\n                        this.removeShop()\n                    }\n                })\n            })\n        },\n        start(e, good) {\n            good.startX = e.changedTouches[0].clientX\n        },\n        end(e, shopIndex, good, goodIndex) {\n            let endX = e.changedTouches[0].clientX\n            let left = '0'\n            if (good.startX - endX > 100) {\n                left = '-60px'\n            } else if (endX - good.startX > 100 ) {\n                left = '0px'\n            }\n\n            Velocity(this.$refs[`goods-${shopIndex}-${goodIndex}`], {\n                left\n            })\n        }\n    },\n    mixins: [mixin]\n})\n\n\n// WEBPACK FOOTER //\n// ./src/pages/cart/cart.js","import axios from 'axios'\r\n\r\nfunction fetch(url, data) {\r\n    return new Promise((resolve, reject) => {\r\n        axios.get(url, data).then(res => {\r\n            let status = res.data.status\r\n            if (status === 200) {\r\n                resolve(res)\r\n            }\r\n            if (status === 300) {\r\n                location.href = 'login.html'\r\n                resolve(res)\r\n            }\r\n            reject(res)\r\n        }).catch(err => {\r\n            reject(err)\r\n        })\r\n    })\r\n}\r\n\r\nexport default fetch\n\n\n// WEBPACK FOOTER //\n// ./src/modules/js/fetch.js"],"sourceRoot":""}